# ============================================================
# TG AntiSpam Bot - Environment Configuration
# ============================================================
# Copy this file to `.env` and adjust values as needed:
#
#   cp .env.example .env
#
# Only APP_BOT_TOKEN and APP_MAIN_ADMIN_ID are strictly required.
# Everything else has reasonable defaults.
# ============================================================


# ----------------------------
# Logging
# ----------------------------

# Log level: DEBUG | INFO | WARNING | ERROR | CRITICAL
APP_LOG_LEVEL=INFO

# Write logs to file (logs/app.log) in addition to stdout
APP_WRITE_TO_FILE=true


# ----------------------------
# Database (SQLite)
# ----------------------------

# Path to SQLite database file
APP_DB_PATH=database/database.db

# Enable SQLAlchemy SQL logging (for debugging only)
APP_DB_ECHO=false

# SQLite connection timeout (seconds)
APP_DB_TIMEOUT=30


# ----------------------------
# Runtime / Server
# ----------------------------

# Port for webhook mode (ignored in polling mode)
APP_RUN_PORT=8000


# ----------------------------
# Telegram Bot
# ----------------------------

# Bot token from @BotFather (REQUIRED)
APP_BOT_TOKEN=PUT_YOUR_TELEGRAM_BOT_TOKEN_HERE

# Bot operation mode: polling | webhook
APP_BOT_MODE=polling

# Public HTTPS URL for webhook mode
# Required only if APP_BOT_MODE=webhook
# Example:
# APP_WEBHOOK_URL=https://your-domain.example
# APP_WEBHOOK_URL=https://xxxx.ngrok-free.app


# ----------------------------
# Administration
# ----------------------------

# Telegram user ID of the main administrator (REQUIRED)
# This user:
# - can access /chats admin panel
# - can activate/deactivate groups
# - is excluded from anti-spam checks
APP_MAIN_ADMIN_ID=PUT_YOUR_TELEGRAM_USER_ID_HERE


# ----------------------------
# Anti-Spam Rules
# ----------------------------

# Minimum time (in minutes) a user must be in a chat
# before being considered trusted
APP_MIN_MINUTES_IN_CHAT=60

# Number of clean messages required before user is trusted
APP_MIN_VALID_MESSAGES=20

# Maximum number of emojis allowed in a message
APP_ANTISPAM_MAX_EMOJIS=5


# ----------------------------
# Anti-Spam Worker Queue
# ----------------------------

# Maximum number of messages waiting in the anti-spam queue
APP_ANTISPAM_QUEUE_SIZE=20000

# Number of background workers processing spam checks
APP_ANTISPAM_WORKERS=8


# ----------------------------
# Fun Commands
# ----------------------------

# Enable fun commands
APP_FUN_COMMANDS_ENABLED=false


# ----------------------------
# AI / LLM (Global Switch)
# ----------------------------

# Enable AI-based spam detection
# true  - AI checks enabled
# false - AI completely disabled (bot works only with rule-based logic)
APP_AI_ENABLED=false


# ----------------------------
# AI Model & Provider
# ----------------------------

# AI provider base URL
# Examples:
#   OpenRouter (chat completions):
#   https://openrouter.ai/api/v1/chat/completions
#
#   Other OpenAI-compatible with /v1/chat/completions:
#   https://api.openai.com/v1/chat/completions
#
#   Local Ollama:
#   http://localhost:11434/api/chat
APP_AI_BASE_URL=

# API key for AI provider
# - Required for cloud APIs
# - Can be dummy value for local Ollama
APP_AI_API_KEY=

# Model name
# Examples:
#   OpenRouter:
#     qwen/qwen-2.5-7b-instruct - small, fast and pretty accurate
#     tngtech/deepseek-r1t2-chimera - big, slow and accurate
#   Local Ollama:
#     qwen2.5:7b-instruct (Ollama) - same as above - best for local Ollama
#   OpenAI:
#     gpt-4o
APP_AI_MODEL=

# Filled ollama example:
# APP_AI_BASE_URL = "http://localhost:11434/api/chat"
# APP_AI_MODEL = "qwen2.5:7b-instruct"
# APP_AI_API_KEY = "0000"


# ----------------------------
# AI Inference Parameters
# ----------------------------

# Sampling temperature (lower = more deterministic)
APP_AI_TEMPERATURE=0.2

# Spam probability threshold
# 0.0 = extremely strict
# 1.0 = extremely permissive
APP_AI_SPAM_THRESHOLD=0.3


# ----------------------------
# AI HTTP Client (Networking)
# ----------------------------

# Max concurrent AI requests
# Recommended:
#   Local Ollama: 1 - ! NOTE: Showing only a single threaded local Ollama - concurrency MUST be set to 1
#   Cloud APIs: 5+
APP_HTTP_CONCURRENCY=5

# Request timeout (seconds)
APP_HTTP_TIMEOUT_S=30.0

# Connection pool settings
APP_HTTP_MAX_CONNECTIONS=40
APP_HTTP_MAX_KEEP_ALIVE_CONNECTIONS=20
APP_HTTP_KEEP_ALIVE_EXPIRY_S=30.0
